name: Run Autobooking Script

on:
  schedule:
    - cron: '0 0 * * 1-6'

jobs:
  run-script:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4

    - name: Set up Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '22'

    - name: Install required packages
      run: npm install

    - shell: bash
      env:
        IS_CLOUD: ${{ secrets.IS_CLOUD }}
        IS_BOOKING_DEBUG: ${{ secrets.IS_BOOKING_DEBUG }}
        LOG_LEVEL: ${{ secrets.LOG_LEVEL }}
        BOOKING_PAGE_URL: ${{ secrets.BOOKING_PAGE_URl }}
        MSFT_EMAIL: ${{ secrets.MSFT_EMAIL }}
        MSFT_PWD: ${{ secrets.MSFT_PWD }}
        STORAGESTATE_FP: ${{ secrets.STORAGESTATE_FP }}
        BOOKING_DATE: ${{ secrets.BOOKING_DATE }}
        BOOKING_TIME_START: ${{ secrets.BOOKING_TIME_START }}
        BOOKING_TIME_END: ${{ secrets.BOOKING_TIME_END }}
        BOOKING_FACILITY: ${{ secrets.BOOKING_FACILITY }}
        BOOKING_PURPOSE: ${{ secrets.BOOKING_PURPOSE }}
        BOOKING_COBOOKER: ${{ secrets.BOOKING_COBOOKER }}

      run: |
        chmod +x ./run_autobooking.sh
        ./run_autobooking.sh
